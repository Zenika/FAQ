# Migration `20190724113932-init`

This migration has been generated by Errorname at 7/24/2019, 11:39:32 AM.
You can check out the [state of the datamodel](./datamodel.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "file:default$default"."Node"("id" TEXT NOT NULL  ,"createdAt" DATE NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,"dummy" BOOLEAN NOT NULL DEFAULT false ,"answer" TEXT   REFERENCES Answer(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Question"("id" TEXT NOT NULL  ,"title" TEXT NOT NULL DEFAULT '' ,"slug" TEXT NOT NULL DEFAULT '' ,"createdAt" DATE NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,"node" TEXT   REFERENCES Node(id),"user" TEXT NOT NULL  REFERENCES User(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Answer"("id" TEXT NOT NULL  ,"content" TEXT NOT NULL DEFAULT '' ,"createdAt" DATE NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,"user" TEXT NOT NULL  REFERENCES User(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Source"("id" TEXT NOT NULL  ,"label" TEXT NOT NULL DEFAULT '' ,"url" TEXT NOT NULL DEFAULT '' ,"answer" TEXT NOT NULL  REFERENCES Answer(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Flag"("id" TEXT NOT NULL  ,"type" TEXT NOT NULL DEFAULT '' ,"createdAt" DATE NOT NULL  ,"node" TEXT NOT NULL  REFERENCES Node(id),"user" TEXT NOT NULL  REFERENCES User(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Tag"("id" TEXT NOT NULL  ,"label" TEXT NOT NULL DEFAULT '' ,"createdAt" DATE NOT NULL  ,"node" TEXT NOT NULL  REFERENCES Node(id),"user" TEXT NOT NULL  REFERENCES User(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."HistoryAction"("id" TEXT NOT NULL  ,"action" TEXT NOT NULL DEFAULT '' ,"model" TEXT NOT NULL DEFAULT '' ,"meta" TEXT   ,"createdAt" DATE NOT NULL  ,"node" TEXT NOT NULL  REFERENCES Node(id),"user" TEXT NOT NULL  REFERENCES User(id),PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."User"("id" TEXT NOT NULL  ,"auth0Id" TEXT   ,"key" TEXT   ,"admin" BOOLEAN NOT NULL DEFAULT false ,"name" TEXT   ,"email" TEXT   ,"picture" TEXT   ,"locale" TEXT   ,"createdAt" DATE NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Configuration"("id" TEXT NOT NULL  ,"name" TEXT NOT NULL DEFAULT '' ,"title" TEXT NOT NULL DEFAULT 'Demo' ,"auth0Domain" TEXT NOT NULL DEFAULT '' ,"auth0ClientId" TEXT NOT NULL DEFAULT '' ,"algoliaAppId" TEXT   ,"algoliaApiKey" TEXT   ,"algoliaSynonyms" TEXT   ,"mailgunDomain" TEXT   ,"mailgunApiKey" TEXT   ,"slackChannelHook" TEXT   ,"slackCommandKey" TEXT   ,"tags" TEXT   ,"workplaceSharing" BOOLEAN   ,"bugReporting" TEXT   ,PRIMARY KEY ("id"));

CREATE TABLE "file:default$default"."Configuration_authorizedDomains"("nodeId" TEXT NOT NULL  REFERENCES Configuration(id),"position" INTEGER NOT NULL  ,"value" TEXT NOT NULL  ,PRIMARY KEY ("nodeId","position"));

CREATE UNIQUE INDEX "file:default$default"."Node.id._UNIQUE" ON "Node"("id")

CREATE UNIQUE INDEX "file:default$default"."Question.id._UNIQUE" ON "Question"("id")

CREATE UNIQUE INDEX "file:default$default"."Answer.id._UNIQUE" ON "Answer"("id")

CREATE UNIQUE INDEX "file:default$default"."Source.id._UNIQUE" ON "Source"("id")

CREATE UNIQUE INDEX "file:default$default"."Flag.id._UNIQUE" ON "Flag"("id")

CREATE UNIQUE INDEX "file:default$default"."Tag.id._UNIQUE" ON "Tag"("id")

CREATE UNIQUE INDEX "file:default$default"."HistoryAction.id._UNIQUE" ON "HistoryAction"("id")

CREATE UNIQUE INDEX "file:default$default"."User.id._UNIQUE" ON "User"("id")

CREATE UNIQUE INDEX "file:default$default"."User.auth0Id._UNIQUE" ON "User"("auth0Id")

CREATE UNIQUE INDEX "file:default$default"."Configuration.id._UNIQUE" ON "Configuration"("id")

CREATE UNIQUE INDEX "file:default$default"."Configuration.name._UNIQUE" ON "Configuration"("name")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20190724113932-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,123 @@
+datasource db {
+  provider = "sqlite"
+  url      = "file:default$default.db"
+  default  = true
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+model Node {
+  id        String          @default(cuid()) @id @unique
+  question  Question?       @relation("NodeQuestion")
+  answer    Answer?         @relation("NodeAnswer")
+  flags     Flag[]          @relation("NodeFlags")
+  tags      Tag[]           @relation("NodeTags")
+  history   HistoryAction[] @relation("NodeHistoryActions")
+  createdAt DateTime        @default(now())
+  updatedAt DateTime        @updatedAt
+  dummy     Boolean
+}
+
+model Question {
+  id        String   @default(cuid()) @id @unique
+  title     String
+  slug      String
+  node      Node?    @relation("NodeQuestion")
+  user      User     @relation("UserQuestions")
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Answer {
+  id        String   @default(cuid()) @id @unique
+  content   String
+  sources   Source[] @relation("AnswerSources")
+  node      Node?    @relation("NodeAnswer")
+  user      User     @relation("UserAnswers")
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Source {
+  id     String @default(cuid()) @id @unique
+  label  String
+  url    String
+  answer Answer @relation("AnswerSources")
+}
+
+model Flag {
+  id        String   @default(cuid()) @id @unique
+  type      String
+  node      Node     @relation("NodeFlags")
+  user      User     @relation("UserFlags")
+  createdAt DateTime @default(now())
+}
+
+model Tag {
+  id        String   @default(cuid()) @id @unique
+  label     String
+  node      Node     @relation("NodeTags")
+  user      User     @relation("UserTags")
+  createdAt DateTime @default(now())
+}
+
+model HistoryAction {
+  id        String   @default(cuid()) @id @unique
+  action    String
+  model     String
+  meta      String?
+  node      Node     @relation("NodeHistoryActions")
+  user      User     @relation("UserHistoryActions")
+  createdAt DateTime @default(now())
+}
+
+model User {
+  id        String          @default(cuid()) @id @unique
+  auth0Id   String?         @unique
+  key       String?
+  admin     Boolean         @default(false)
+  name      String?
+  email     String?
+  picture   String?
+  locale    String?
+  questions Question[]      @relation("UserQuestions")
+  answers   Answer[]        @relation("UserAnswers")
+  flags     Flag[]          @relation("UserFlags")
+  tags      Tag[]           @relation("UserTags")
+  history   HistoryAction[] @relation("UserHistoryActions")
+  createdAt DateTime        @default(now())
+  updatedAt DateTime        @updatedAt
+}
+
+model Configuration {
+  id String @default(cuid()) @id @unique
+
+  name  String @unique
+  title String @default("Demo")
+
+  auth0Domain       String
+  auth0ClientId     String
+  authorizedDomains String[]
+
+  algoliaAppId    String?
+  algoliaApiKey   String?
+  algoliaSynonyms String?
+
+  mailgunDomain String?
+  mailgunApiKey String?
+
+  slackChannelHook String?
+  slackCommandKey  String?
+
+  tags String?
+
+  workplaceSharing Boolean?      @default(false)
+  bugReporting     BugReporting? @default(GITHUB)
+}
+
+enum BugReporting {
+  MAIL
+  GITHUB
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20190724113932-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20190724113932-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
